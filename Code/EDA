#libraries
library(ggplot2)
library(ggcorrplot)
library(tidyverse)
library(dplyr)

#Claims dataset
#Importing claims dataset
library(readr)
claims_data <- read_csv("Desktop/Assignment/Assignment Data Download (Confidential Insurance Data)-20240921/UNSW_claims_data.csv")

#Import earned dataset
library(readr)
earned_data <- read_csv("Desktop/Assignment/Assignment Data Download (Confidential Insurance Data)-20240921/UNSW_earned_data.csv")
View(earned_data)


#Inspecting claims dataset
View(claims_data)
str(claims_data) #all structures are fine
dim(claims_data) #3487 rows x 8 columns
head(claims_data)
tail(claims_data)
is.na(claims_data)

#Claims count for different types of conditions
# Barplot of claim exposure using ggplot2
count = nrow(claims_data)
ggplot(claims_data, aes(x = condition_category)) +
  geom_bar(fill="skyblue4",colour="black") +
  labs(title = "Barplot of Claim Count for Different Conditions", x = "Condition", y = "Count") + theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
  
# Density of claim exposure using ggplot2
count = nrow(claims_data)
ggplot(claims_data, aes(x = condition_category)) +
  geom_density(fill="skyblue4",alpha=0.5) +
  labs(title = "Density of Claim Count for Different Conditions", x = "Condition", y = "Count") + theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))


#Density of tenures
ggplot(claims_data, aes(x = tenure)) +
  geom_density(fill="skyblue4", alpha = 0.75) + theme_minimal()+theme(plot.title = element_text(hjust = 0.5)) +
  ggtitle("Density of Tenure") +
  xlab("Tenure")
  
#Claim amount and tenure
ggplot(claims_data ,aes(x = tenure, y = total_claim_amount)) +
  geom_point(colour = "skyblue4") + theme(axis.title=element_text(size=1.5,face="bold")) +
  labs(title = "Claim Amount Against Tenure", x = "Tenure", y = "Claim Amount") + theme_minimal()


#Claim status and category
categorical_variables_claims <- table(claims_data$condition_category, claims_data$claim_status)
View(categorical_variables_claims)


#Relationship between Condition category and claim status
ggplot(claims_data, aes(x = condition_category, y = claim_status, fill = claim_status)) +
  geom_bar(stat = "identity") +
  labs(title = "Stacked Bar Plot of Condition as per Status", x = "Conditions", y = "Status") +
  theme_minimal() + theme(
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),  # Adjust x-axis text
    axis.text.y = element_text(size = 0)  # Adjust y-axis text size (you can customize further))
  

#Correlation 
str(claims_data)

correlation_data <- claims_data %>% select(tenure, claim_paid, total_claim_amount)
correlation_matrix <- cor(correlation_data, method = "pearson")
print(correlation_matrix)
View(correlation_matrix)






